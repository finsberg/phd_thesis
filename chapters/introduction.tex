\chapter{Introduction}

% Further development in medical research require insight into complex
% systems, that is too complicated to study with mathematical models and
% super computers.

% Further development in medical sciences cannot only rely on Moore's
% law but also improvement on mathematical models and numerical
% methods. 

% To lower the risk for the patient we need to more accuratley dioagnose
% the patient, and find the optimal treatment.

% Personalized medican at the level of the individual. 

% Many variables to take into account

% The story of biomechanics starts in the 17th century with Giovanni
% Borelli, known as the father of Biomechanics. He was the first one to
% apply the mathematical techniques of Gallileo Galliei to study the
% movement of animals.

\section{Aim of thesis}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% THE PAST %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Cardiovascular diseases are the leading cause of death in the
world, responsible for more than 17.3 million deaths annually, a
number that is expected to reach 23.6 million by 2030
\cite{writing2016heart}. Advancements in detection and treatment
have reduced morbidity and mortality, but knowledge of the underlying
mechanisms for the development of the disease is still very poor.
While some patients respond very well to a therapy, others suffering
from the same symptoms might not respond at all.
Our understanding of these mechanisms has been improved through
development of advance imaging techniques and through
computational modeling. While imaging play a central role in
assessment of cardiac structure and kinematics, biophysical models can
help us to understand causality in this multiscale environment.  

% \section{Historical note}

One of the earliest examples of modelling applied to cardiac
physiology dates back to 1892 when Robert Wood approximated the
ventricle as a thinned-wall spherical shell \cite{woods1892few}, and
formulated the well known \emph{Law of Laplace}.
% In this way, \emph{wall
% stress} could be analytically estimated via the famous \emph{Law of Laplace}
% \cite{woods1892few}. This law relates the wall stress $\sigma$ to the endocardial
% pressure $P$, the endocarial radius $r$ and the wall thickness $w$
% and can in its simplest for be expressed as
% \begin{align}
%   \sigma = \frac{P \times r}{2 w}.
% \end{align}
% Wall stress can be thought of as the load that the heart must work
% against, and it is therefore important to understand how different
% quantities affects the working heart. For instance when the heart
% ejects blood, the load that the heart ejects blood against is
% typically referred to as \emph{afterload}, but this is really the same
% as the wall stress in that particular state. 
% Even though it is obvious that the shape of a ventricle in most cases
% clearly deviates from a sphere, this forumla provides clinician with a tool
% that can be used to understand how diseases affect the heart. Take for
% example the case of ventricular dilation, when the inner radius of 
% the ventricle increases, resulting in increased wall stress and
% hence the heart has to work harder in order to eject blood to the body. In the other
% end we have the case of concentric hypertrophy which results in wall
% thickening and hence reduced the wall stress. In this case more muscle
% fibers are recruited and therefore the tension experienced by each
% individual unit will be less. 
Since 1892 more realistic and sophisticated models have been developed
in order to better describe the anatomical as well as the biophysical
nature of the ventricle. The first extension came in 1927 to
thick-walled spheres \cite{love2013treatise}. In the 1960s the spheres
were substituted by ellipsoids, with thin-walled models in 1963
\cite{sandler1963left}, and with thick-walled models in 1968
\cite{wong1968stress}. A thorough comparison of the different early
models  is presented in \cite{huisman1980comparison}. The first
reported usage of image-based geometries dates back to 1972
\cite{gould1972vivo}, were X-ray was used to image the left ventricle
and the finite element method was used to estimate wall stress. The relatively
poor computational power, together with the low image quality really
challenged the biomedical bioengineers at that time. The following
phrase, taken form \cite{heethaar1977computer} illustrates this fact:  
\emph{``Programming for the solution of the large number of
  simultaneous linear equations generated by the finite element method
  on computers with capacity not exceeding 32K words of memory
  required special attention to very compact storage of the
  stiffness matrix and the retrieval of its coefficients''}.

A paradigm shift in the field of cardiac mechanics modeling came in
the late 1980s at the University of Auckland. Here the first models
based on a continuum description of the heart were developed
\cite{hunter1988analysis}, which is still in use today. 



% Looking back in time, we see that great progress have been made
% towards personalized medicin. Recent discoveries such as mapping out
% all the genes in the human genome shows that

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% THE PRESENT %%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Today, advanced imaging techniques allow us to acquire detailed
mechanical information about the heart of the individual. In addition,
advanced numerical algorithms combined with high performance computing
power enable us to get more and more detailed simulation of a patients
heart. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%% THE FUTURE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%

The need for building adequate patient-specific models that captures
the geometrical information observed in the images as well as the
underlying biophysical processes, is recognized as one of the key
challenges in modern bioengineering \cite{hunter2010vision}. This is
also reflected in the exponential increase in the yearly number of
publications on the topic \cite{sack2016personalised}.
In the future, models could be used to as a diagnostic tool to extract
features from a patients heart that are otherwise impossible to extract from
images. Eventually, models could potentially predict the outcome of
different treatment strategies and guide clinicians in the decision making.

In other parts of physical sciences and engineering, such as the
space industry or meteorology, the role of the computational
science has been crucial for its development. Without the increasing
computational power predicted by Moore's law
\cite{brock2006understanding} and better numerical methods, such as the
finite element method, scientist would not have been able to predict
complex physical phenomena such as a Tsunami, or being able to send
humans out in space. 

Despite our ability to simulate complex physical systems such as
the weather, we still have a way to go before we are able to
simulate a human organ, such as the heart, with the same precision. The
multiscale nature of biophysical processes has challenged engineers for decades.
Even though we understand processes at each level, such as the flow of
ions in and out of the cell, or the electrical transduction through the
heart, the question of how to couple these levels together is still open
\cite{noble2002modeling}.

Another question is how to fuse data observed in medical images with
computational models, in order to make models specific to the
individual. These questions has to be addressed before we can take the
next step into personalized simulations for \emph{in silico} medicine,
and use computer simulations to guide treatment, and predict outcome.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%% THIS THESIS %%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Some of these unanswered question serve as motivation for the work
conducted in this thesis. We focus purely on the mechanical modeling
of the heart and the aim has been to develop a framework for
building mechanical models that are personalized at the level of the
individual.

The mechanics of the heart can be described via equations of nonlinear
elasticity which is traditionally formulated using a continuum
mechanics approach. This approach has been extensively used in other
parts of engineering, and numerical solutions to these partial
differential equations (PDE) are solved using the finite element
method (FEM) with the open source software package FEniCS \cite{logg2012automated}.

These mechanical models contain model parameters which may vary from
individual to individual, and patient specificity can be obtained by
fitting these model parameters to additional clinical data. This
process is often referred to as data assimilation, a field that has
its root in meteorology where one want to make a weather forecast based
on observations from strategically placed weather stations. The idea
is to construct a functional which represent the mismatch between the
model and the observations, and by changing the model parameters we
also change the value of this mismatch functional. Now, what we want to do is to
minimize this functional using these model parameters as control. At
the same time, the governing PDE, which depend upon these model
parameters, has to remain true. We therefore often
refer to such problems as PDE-constrained optimization problems.  
Solving such problems is challenging because evaluation of the
mismatch functional requires the solution of a nonlinear PDE, which is
computationally expensive, and we therefore want to keep the number of
functional evaluations at a minimum. A good way of doing this is
traverse the parameter space along the gradient descent, which is
guaranteed to bring us towards a local minimum. However, this requires
calculation of the functional gradient, or the derivative of the
mismatch functional with respect to the model parameters. As we will
see, the functional gradient can be computed efficiently by
considering the adjoint equation, and recent development in numerical
software tools \cite{farrell2013automated} allow us to exploit this
also numerically.


The developed framework in this thesis could be applied directly to
estimate high dimensional model parameters without any manual tuning of
parameters. The aim has been to develop a framework for automatic
generation of patient-specific simulations of the heart, by fitting
model-parameters to potentially ``any'' type of clinical data. In particular,
incorporating regional motion data to estimate spatially resolved
parameters has been an essential contribution in this thesis. This
type of automated simulation pipeline could potentially be integrated
as a part of a clinical diagnostic toolbox and be used to guide clinicians in the
decision-making and treatment planning. In particular, such models can
be used to assess information that is difficult or even impossible to
measure in the human heart, such as indices of contractility,
myocardial work and myofiber stress. While the first part of the
thesis (Paper 1) is concerned with developing a framework for
constraining a mechanics model to clinical data, the second part
(Paper 2, 3 and 4) evaluates potentially useful biomarkers extracted from
the personalized mechanics model. Future work should be geared towards
validation of such models, in order to unleash its potential in the
clinic.

The remaining introduction in this thesis is organized as follows. In
Section \ref{sec:intro_physiology} we briefly explain some concepts in
cardiac anatomy and physiology which is used throughout the
thesis. This section ends with a description of the different cardiac
diseases encountered in this thesis. In Section
\ref{sec:intro_mechanical} we give an introduction to continuum
mechanics and mechanical modeling of the heart. The basic equations of
elasticity as well as the constitutive relations for the cardiac
tissue, and some numerical considerations are covered. In Section 
\ref{sec:intro_personalization} we explain how to personalize a
mechanical model using clinical data. We start by explaining the
different imaging modalities used in this thesis, and how finite
element meshes are created from images. We also explain how to find a
more realistic reference geometry than the one obtained from medical
images. At the end we introduce data assimilation, and how to compute
the functional gradient using the adjoint method. Finally in Section
\ref{sec:summary} we summarize the research papers that make up this
thesis, and make some closing remarks and suggestions for future
directions. 

\newpage
% An even greater challenge 


% The problem
% of utilising this information to costrain models to become patient
% specific 


% Together with increased computing power, this is perhaps
% the main reason for why computational models today are able to capture
% detailed information 


% \begin{itemize}
% \item Building models that are specified at the level of the
%   individual.
% \item Using patient observations to constrain model, while at the same
%   time ensuring that the underlying physical equations are satisfied. 
% \end{itemize}

% \input{chapters/introduction/aim_of_thesis}
\input{chapters/introduction/physiology}
\newpage
\input{chapters/introduction/mechanics}
\newpage
\input{chapters/introduction/patient}
\newpage
\input{chapters/introduction/summary}


\newpage


\bibliographystyle{plain}
\bibliography{chapters/introduction/bibliography}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../main"
%%% End:
